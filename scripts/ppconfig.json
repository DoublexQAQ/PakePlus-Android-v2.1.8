{"name":"cbfcefea","url":"https://www.acgkkkk.com/","showName":"ACG动漫","appid":"com.cbfcefea.pakeplus","icon":"","iconPath":"C:\\Users\\lisen\\AppData\\Roaming\\com.pakeplus.pacbao\\zcuzdnwz1v.png","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":false,"version":"1.0.3","preview":"desktop","platform":["1-1"],"width":800,"height":600,"desc":"","jsFile":[],"filterCss":"","customJs":"// very important, if you don't know what it is, don't touch it\n// 非常重要，不懂代码不要动，这里可以解决80%的问题，也可以生产1000+的bug\nconst hookClick = (e) => {\n    const origin = e.target.closest('a')\n    const isBaseTargetBlank = document.querySelector(\n        'head base[target=\"_blank\"]'\n    )\n    console.log('origin', origin, isBaseTargetBlank)\n    if (\n        (origin && origin.href && origin.target === '_blank') ||\n        (origin && origin.href && isBaseTargetBlank)\n    ) {\n        e.preventDefault()\n        console.log('handle origin', origin)\n        location.href = origin.href\n    } else {\n        console.log('not handle origin', origin)\n    }\n}\n\nwindow.open = function (url, target, features) {\n    console.log('open', url, target, features)\n    location.href = url\n}\n\ndocument.addEventListener('click', hookClick, { capture: true })\n\n(function () {\n    if (window.__ACG_HOOK__) return;\n    window.__ACG_HOOK__ = true;\n\n    console.log(\"[PakePlus] ACG Video Helper Loaded\");\n\n    /* ========= 设备识别 ========= */\n    const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);\n\n    /* ========= 存储视频 URL ========= */\n    const videoUrls = new Set();\n\n    /* ========= Hook fetch ========= */\n    const rawFetch = window.fetch;\n    window.fetch = function (...args) {\n        const url = args[0]?.url || args[0];\n        if (typeof url === \"string\" && /\\.(m3u8|mp4)(\\?|$)/i.test(url)) {\n            videoUrls.add(url);\n            console.log(\"[Video URL]\", url);\n        }\n        return rawFetch.apply(this, args);\n    };\n\n    /* ========= Hook XHR ========= */\n    const rawOpen = XMLHttpRequest.prototype.open;\n    XMLHttpRequest.prototype.open = function (method, url) {\n        if (typeof url === \"string\" && /\\.(m3u8|mp4)(\\?|$)/i.test(url)) {\n            videoUrls.add(url);\n            console.log(\"[Video URL]\", url);\n        }\n        return rawOpen.apply(this, arguments);\n    };\n\n    /* ========= 自动横屏（手机端） ========= */\n    function lockLandscape() {\n        if (!isMobile) return;\n        if (screen.orientation && screen.orientation.lock) {\n            screen.orientation.lock(\"landscape\").catch(() => {});\n        }\n    }\n\n    /* ========= 下载按钮 ========= */\n    function createDownloadBtn() {\n        if (document.getElementById(\"acg-download-btn\")) return;\n\n        const btn = document.createElement(\"div\");\n        btn.id = \"acg-download-btn\";\n        btn.innerText = \"⬇ 下载\";\n        btn.style.cssText = `\n            position: fixed;\n            top: 80px;\n            right: 10px;\n            z-index: 99999;\n            background: rgba(0,0,0,.6);\n            color: #fff;\n            padding: 8px 12px;\n            border-radius: 6px;\n            font-size: 14px;\n        `;\n\n        btn.onclick = () => {\n            if (!videoUrls.size) {\n                alert(\"未捕获到视频地址\");\n                return;\n            }\n\n            const url = [...videoUrls][videoUrls.size - 1];\n\n            if (url.endsWith(\".m3u8\")) {\n                prompt(\"复制 m3u8 地址（可用 N_m3u8DL / ffmpeg）：\", url);\n            } else {\n                window.open(url);\n            }\n        };\n\n        document.body.appendChild(btn);\n    }\n\n    /* ========= 监听 ArtPlayer ========= */\n    const observer = new MutationObserver(() => {\n        const video = document.querySelector(\"video\");\n        const player = document.querySelector(\".art-video-player\");\n\n        if (video && player) {\n            createDownloadBtn();\n\n            video.addEventListener(\"fullscreenchange\", lockLandscape);\n            video.addEventListener(\"webkitfullscreenchange\", lockLandscape);\n\n            observer.disconnect();\n            console.log(\"[PakePlus] ArtPlayer Ready\");\n        }\n    });\n\n    observer.observe(document.body, { childList: true, subtree: true });\n})();","isHtml":false,"htmlPath":"","htmlFiles":[],"prefix":"","pcRepo":"PakePlus-v2.1.8","iosRepo":"PakePlus-iOS-v2.1.8","androidRepo":"PakePlus-Android-v2.1.8","more":{"windows":{"label":"","title":"ACG动漫","url":"https://www.acgkkkk.com/","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36","width":800,"height":600,"theme":null,"resizable":true,"fullscreen":false,"maximized":false,"minWidth":400,"minHeight":300,"maxWidth":1920,"maxHeight":1080,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":false,"shadow":true,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false,"backgroundColor":null,"backgroundThrottling":null,"javascriptDisabled":false}},"phone":{"fullScreen":false,"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"cbfcefea","showName":"ACG动漫","version":"1.0.3","webUrl":"https://www.acgkkkk.com/","id":"com.cbfcefea.pakeplus.ios","icon":"./app-icon.png","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"android":{"name":"cbfcefea","showName":"ACG动漫","version":"1.0.3","webUrl":"https://www.acgkkkk.com/","id":"com.cbfcefea.pakeplus.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"desktop":{"name":"cbfcefea","showName":"ACG动漫","version":"1.0.3","id":"com.cbfcefea.pakeplus.desktop","desc":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","webUrl":"https://www.acgkkkk.com/","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","isHtml":false,"single":false,"state":true,"injectJq":false,"tauriApi":false,"buildMethod":"local","debug":true}}